# 画面遷移図

## 🎓 受講生向け画面遷移

```
┌─────────────┐
│ ログイン画面  │ ← 未認証時の初期画面
└──────┬──────┘
       │ Google OAuth認証
       ↓
┌─────────────┐
│ 承認状態判定  │
└──────┬──────┘
       │
       ├─[未承認]→ ┌──────────────┐
       │           │ 承認待ち画面    │ ← 承認されるまで待機
       │           └──────────────┘
       │
       └─[承認済み]→ ┌──────────────┐
                     │ ホーム画面      │ ← メインダッシュボード
                     └────┬─────┬───┘
                          │     │
         ┌────────────────┤     └──────────────┐
         │                │                    │
         ↓                ↓                    ↓
   ┌──────────┐    ┌──────────┐        ┌──────────┐
   │コンテンツ │    │課題提出・  │        │お知らせ   │
   │一覧画面   │    │履歴画面   │        │一覧画面   │
   └────┬─────┘    └────┬─────┘        └──────────┘
        │                 │
        │                 ↓
        ↓           ┌──────────┐
   ┌──────────┐    │課題提出   │
   │コンテンツ │    │フォーム   │
   │詳細画面   │    └──────────┘
   └──────────┘
   - 動画教材
   - テキスト教材
   - 演習課題
```

### 画面説明

| 画面名 | URL例 | 主要機能 |
|-------|------|---------|
| ログイン | `/login` | Google OAuth認証 |
| 承認待ち | `/pending-approval` | 承認待ちメッセージ表示 |
| ダッシュボード | `/student/dashboard` | 進捗サマリー、最新お知らせ、学習開始ボタン |
| コンテンツ一覧 | `/student/contents` | Phase/Week階層表示、進捗状況 |
| コンテンツ詳細 | `/student/contents/[id]` | 教材表示、完了ボタン |
| 課題提出・履歴 | `/student/submissions` | 提出済み課題一覧、フィードバック確認 |
| 課題提出フォーム | `/student/submissions/new?contentId=[id]` | コード貼り付け、URL入力 |
| お知らせ一覧 | `/student/announcements` | 全お知らせの一覧表示 |

## 👨‍💼 運営向け画面遷移

```
┌─────────────┐
│ ログイン画面  │ ← 未認証時の初期画面
└──────┬──────┘
       │ Google OAuth認証（運営権限）
       ↓
┌─────────────────┐
│ ダッシュボード      │ ← 統計サマリー表示
└────┬────┬───┬───┘
     │    │   │
     │    │   └────────────┐
     │    │                 │
     │    └────────┐        │
     │             │        │
     ↓             ↓        ↓
┌─────────┐  ┌─────────┐  ┌─────────┐
│受講生管理 │  │課題管理   │  │コンテンツ│
│画面      │  │画面      │  │管理画面  │
└────┬────┘  └────┬────┘  └────┬────┘
     │             │             │
     ↓             ↓             ↓
┌─────────┐  ┌─────────┐  ┌─────────┐
│受講生詳細│  │課題詳細・ │  │コンテンツ│
│画面      │  │フィード   │  │編集画面  │
│          │  │バック    │  │          │
└─────────┘  └─────────┘  └─────────┘

     ┌──────────────────┐
     │ お知らせ管理画面    │
     └──────────────────┘
     ┌──────────────────┐
     │ 承認管理画面        │
     └──────────────────┘
```

### 画面説明

| 画面名 | URL例 | 主要機能 |
|-------|------|---------|
| ダッシュボード | `/instructor/dashboard` | 全体統計、KPI表示 |
| 受講生管理 | `/instructor/students` | 全受講生一覧、進捗率表示 |
| 受講生詳細 | `/instructor/students/[id]` | 個別進捗詳細、提出課題履歴 |
| 承認管理 | `/instructor/approvals` | 新規登録申請の承認/却下 |
| 課題管理 | `/instructor/submissions` | 全提出課題一覧、未確認フィルタ |
| 課題詳細・フィードバック | `/instructor/submissions/[id]` | 提出内容確認、フィードバック入力 |
| コンテンツ管理 | `/instructor/contents` | Phase/Week/Content CRUD |
| コンテンツ編集 | `/instructor/contents/[id]/edit` | 教材編集（Markdown、YouTube URL） |
| お知らせ管理 | `/instructor/announcements` | お知らせCRUD |

## 🔐 認証フロー

```
┌──────────┐
│ アクセス  │
└─────┬────┘
      │
      ↓
┌──────────────┐
│ 認証状態確認  │
└──────┬───────┘
       │
       ├─[未認証]─→ ┌──────────┐
       │             │ /login へ  │
       │             │ リダイレクト│
       │             └──────────┘
       │
       ↓
┌──────────────┐
│ 承認状態確認  │
└──────┬───────┘
       │
       ├─[未承認]─→ ┌────────────────┐
       │             │ /pending-approval │
       │             │ へリダイレクト     │
       │             └────────────────┘
       │
       ├─[承認済み・受講生]─→ 受講生向け画面
       │
       └─[承認済み・運営]──→ 運営向け画面
```

## 🚨 エラー・例外処理フロー

```
エラー発生
   │
   ├─[認証エラー]──→ /login へリダイレクト
   │
   ├─[権限エラー]──→ 403エラー画面
   │
   ├─[404エラー]──→ 404エラー画面
   │
   └─[その他エラー]→ 500エラー画面
                      - エラーログ記録
                      - Slack通知（重大エラー）
```

## 🔄 状態遷移パターン

### 受講生の学習フロー

```
ログイン → ホーム → コンテンツ一覧 → コンテンツ詳細（動画視聴）→ 完了ボタン
                                  ↓
                               進捗更新
                                  ↓
                            次のコンテンツへ
                                  ↓
                            演習課題に到達
                                  ↓
                            課題提出フォーム
                                  ↓
                            提出完了
                                  ↓
                     フィードバック待ち（課題履歴で確認）
```

### 運営の課題確認フロー

```
ダッシュボード → 課題管理画面（未確認フィルタ）→ 課題詳細
                                              ↓
                                     フィードバック入力
                                              ↓
                                          保存ボタン
                                              ↓
                                     受講生にメール通知
                                     アプリ内通知表示
```

## 📱 レスポンシブ対応

### PC（デスクトップ）
- サイドバーナビゲーション常時表示
- 2カラムレイアウト（一覧・詳細）
- リッチなUIコンポーネント

### タブレット
- ハンバーガーメニュー
- 1カラムレイアウト
- タッチ操作最適化

### スマートフォン
- ボトムナビゲーション（受講生）
- シンプルなカード型UI
- 情報確認用途

---

**改訂履歴**

| 日付 | 内容 |
|------|------|
| 2024年12月 | 初版作成 |
| 2024年12月22日 | ルート衝突回避のため、運営向けURLを `/admin/*` から `/instructor/*` に変更 |
